openapi: 3.0.1
info:
  title:  Training platform API
  description: Dataset management and model training
  version: '1.1'
servers:
  - url: http://localhost:5000/
    description: Local server
#  - url: http://localhost:5000/
#    description: Local server
paths:
  /labelClass/list:
    get:
      summary: 获取标注类别列表
      tags:
        - 标签管理
      operationId: gets the list of labelClass
      parameters:
        - in: query
          name : page
          description: page number, default 1
          schema:
            type: integer
        - in: query
          name : limit
          description: page size, default 10
          schema:
              type: integer
        - in: query
          name: gteCreatedAt
          description: 标注类别创建开始时间(大于等于),秒级时间戳
          schema:
              type: integer
              description: 秒级时间戳,创建时间大于等于
        - in: query
          name: ltCreatedAt
          description: 标注类别创建结束时间(小于),秒级时间戳
          schema:
              type: integer
              description: 秒级时间戳,创建时间小于
        - in: query
          name: labelName
          description: 标注类别名称,模糊匹配
          schema:
            type: string
        - in: query
          name: labelKey
          description: 标注类别key,模糊匹配
          schema:
            type: string

      responses:
        '200':
          description: got back the list of labelClass
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/labelClasses'
  /labelClass/get/{{id}}:
    get:
      summary: 获取标注类别详细信息
      tags:
        - 标签管理
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: got back labelClass info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/labelClassBody'
  /labelClass/save:
    post:
      summary: 添加标注类别
      tags:
        - 标签管理
      responses:
        '200':
          description: ' add the specified labelClass'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/labelClassAddBody'
  /labelClass/remove:
    post:
      summary: 删除标注类别
      tags:
        - 标签管理
      responses:
        '200':
          description: ' remove the specified labelClass'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/labelClassRemoveBody'
  /labelClass/update/{{id}}:
    post:
      summary: 更新标注类别
      tags:
        - 标签管理
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ' update the specified labelClass'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/labelClassUpdateBody'

  /labeledData/list:
    get:
      summary: 查询标注样本列表
      tags:
        - 样本管理
      operationId: gets the list of labeledDatas
      parameters:
        - in: query
          name : page
          description: page number, default 1
          schema:
            type: integer
        - in: query
          name : limit
          description: page size, default 10
          schema:
              type: integer
        - in: query
          name: sourceType
          description: 标注样本来源,0:导入,1:采集
          schema:
              type: integer
        - in: query
          name: sourceId
          description: 样本来源id(sourceType为1时表示采集摄像头sn,sourceType为0时无意义)
          schema:
              type: string
        - in: query
          name: datasetsId
          description: 标注样本所属数据集
          schema:
              type: integer
        - in: query
          name: labelClassIds
          description: 根据标注类别的 id 过滤，支持数组同时过滤多个,逗号分隔
          schema:
              type: integer
        - in: query
          name: gteCreatedAt
          description: 秒级时间戳,创建时间大于等于
          schema:
              type: string
        - in: query
          name: ltCreatedAt
          description: 秒级时间戳,创建时间小于
          schema:
              type: string
      responses:
        '200':
          description: got back the list of labeledDatas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/labeledDatas'
  /labeledData/get/{{id}}:
    get:
      summary: 查询标注样本详细信息
      tags:
        - 样本管理
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: got back labeledData info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/labeledDataGetBody'
  /labeledData/update:
    post:
      summary: 更新标注样本
      tags:
        - 样本管理
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ' update the specified labeledData'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/labeledDataUpdateBody'
  /labeledData/remove:
    post:
      summary: 删除标注样本
      tags:
        - 样本管理
      responses:
        '200':
          description: ' delete the specified labeledData'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/labeledDataRemoveBody'
  /labeledData/save:
    post:
      summary: 添加标注样本
      tags:
        - 样本管理
      responses:
        '200':
          description: ' add the specified labeledData'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/labeledDataAddBody'
  /labeledData/exports:
    get:
      summary: 导出标注样本压缩包
      tags:
        - 样本管理
      requestBody:
        required: true
        content:
          query:
            schema:
              $ref: '#/components/schemas/labeledDataExportBody'
#          application/json:
#            schema:
#              $ref: '#/components/schemas/labeledDataExportBody'
      responses:
        '200':
          description: ' exports the specified labeledData'
          content:
            application/json:
                schema:
                    $ref: '#/components/schemas/dataExportResult'
  /labeledData/import:
    post:
      summary: 导入标注样本压缩包
      tags:
        - 样本管理
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
                - md5
              properties:
                file:
                  type: string
                  format: binary
                  maximum: 512000
                md5:
                    type: string
                    description: 文件md5
      responses:
        '200':
          description: ' import the specified labeledData'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'

  /datasets/list:
    get:
      summary:  查询数据集列表
      tags:
        - 数据集管理
      operationId: gets the list of datasets
      parameters:
        - in: query
          name : page
          description: page number, default 1
          schema:
            type: integer
        - in: query
          name : limit
          description: page size, default 10
          schema:
              type: integer
        - in: query
          name: gteCreatedAt
          description: 秒级时间戳,创建时间大于等于
          schema:
              type: integer
        - in: query
          name: ltCreatedAt
          description: 秒级时间戳,创建时间小于
          schema:
              type: integer
        - in: query
          name: name
          description: 数据集名称,模糊匹配
          schema:
              type: string
        - in: query
          name: id
          description: 数据集id
          schema:
              type: string

      responses:
        '200':
          description: got back the list of datasets
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/datasets'
  /datesets/save:
    post:
      summary: 创建数据集
      tags:
        - 数据集管理
      responses:
        '200':
          description: ' add the specified dataset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/datasetBody'
  /datasets/get/{{id}}:
    get:
      summary: 获取数据集详细信息
      tags:
        - 数据集管理
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: got back dataset info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/datasetGetBody'

  /datesets/update/{{id}}:
    post:
      summary: 更新数据集
      tags:
        - 数据集管理
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: ' update the specified dataset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/datasetUpdateBody'
  /datasets/addData:
    post:
      summary: 添加标注样本到数据集
      tags:
        - 数据集管理
      parameters:
        - in: path
          required: true
          name: id
          schema:
            type: string
        - in: query
          name: labeledDataIds
          schema:
            type: array
            items:
              type: string
      responses:
        '200':
          description: ' add the specified labeledDatas to dataset'
          content:
              application/json:
                schema:
                    $ref: '#/components/schemas/result'
  /datasets/removeData:
    post:
      summary: 从数据集中移除标注样本
      tags:
        - 数据集管理
      parameters:
        - in: path
          required: true
          name: id
          schema:
            type: string
        - in: query
          name: labeledDataIds
          schema:
            type: array
            items:
              type: string
      responses:
        '200':
          description: ' remove the specified labeledDatas from dataset'
          content:
              application/json:
                schema:
                    $ref: '#/components/schemas/result'
  /datasets/exports/{{id}}:
    get:
      summary: 导出数据集
      tags:
        - 数据集管理
      parameters:
        - in: path
          required: true
          name: id
          schema:
            type: string
      responses:
        '200':
          description: ' export the specified dataset'
          content:
            application/json:
                schema:
                    $ref: '#/components/schemas/dataExportResult'

  /model/import:
    post:
      summary: 导入模型
      tags:
        - 模型管理

      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
#                - chipType
#                - engineId
#                - algorithmType
                - md5
              properties:
                file:
                  type: string
                  format: binary
                  maximum: 512000
#                chipType:
#                  type: string
#                  description: 芯片类型
#                  enum:
#                    - Rockchip,1808,NPU
#                    - SOPHGO,SE5,NPU
#                engineId:
#                  type: string
#                  description: 引擎Id 1:共达地  0:7G
#                  enum:
#                    - 0
#                    - 1
#                algorithmType:
#                    type: string
#                    enum:
#                      - Detection
#                      - Compare
#                      - Structuration
                md5:
                  type: string
                  description: 文件md5
#                duration:
#                  type: integer
#                  description: 模型训练时长,单位分钟

      responses:
        '200':
          description: ' import the specified model'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
  /model/exports/{{id}}:
    get:
      summary: 导出模型
      tags:
        - 模型管理
      parameters:
        - in: path
          required: true
          name: id
          schema:
            type: string
      responses:
        #返回文件
        '200':
          description: ' export the specified model'
          content:
              application/zip:
                schema:
                    type: string
                    format: binary

  /model/list:
    get:
      summary: 查询模型列表
      tags:
        - 模型管理
      operationId: gets the list of models
      parameters:
        - in: query
          name : page
          description: page number, default 1
          schema:
            type: integer
        - in: query
          name : limit
          description: page size, default 10
          schema:
            type: integer
        - in: query
          name: gteCreatedAt
          description: 秒级时间戳,创建时间大于等于
          schema:
            type: integer
        - in: query
          name: ltCreatedAt
          description: 秒级时间戳,创建时间小于
          schema:
            type: integer
        - in: query
          name: name
          description: 模型名称,模糊匹配
          schema:
            type: string
        - in: query
          name: status
          description: 模型状态
          schema:
              type: string
        - in: query
          name: algorithmType
          description: 算法类型
          schema:
            type: string
        - in: query
          name: chipType
          description: 芯片类型/产品型号
          schema:
            type: string
        - in: query
          name: engineId
          description: 算法厂家
          schema:
            type: string
      responses:
        '200':
          description: got back the list of models
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/modelList'
  /model/get/{{id}}:
    get:
      summary: 获取模型详细信息
      tags:
        - 模型管理
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: got back model info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/modelGetBody'
  /model/update:
    post:
      summary: 更新模型
      tags:
        - 模型管理
      responses:
        '200':
          description: ' update the specified model'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/modelUpdateBody'

  /data-engine/api/v1/model/list:
    get:
      summary: 获取模型列表
      tags:
        - 模型服务
      operationId: gets the list of model
      parameters:
        - in: query
          name : page
          description: page number, default 1
          schema:
            type: integer
        - in: query
          name : limit
          description: page size, default 10
          schema:
              type: integer
      responses:
        '200':
          description: got back the list of model
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/modelList'

  /knowledge/api/v1/aiEvent/sync:
    post:
      summary: AI知识事件同步
      tags:
        - 规则聚合服务
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ruleEventBody'

      responses:
        '200':
          description: ' rule control'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
  /rule/api/v1/rule/save:
    post:
      summary: 任务添加
      tags:
        - 规则聚合服务
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ruleBody'

      responses:
        '200':
          description: ' rule control'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/resultData'
  /rule/api/v1/rule/update:
    post:
      summary: 任务更新
      tags:
        - 规则聚合服务
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ruleUpdateBody'

      responses:
        '200':
          description: ' rule control'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
  /rule/api/v1/rule/list:
    get:
      summary: 获取任务列表
      tags:
        - 规则聚合服务
      operationId: gets the list of rule
      parameters:
        - in: query
          name : page
          description: page number, default 1
          schema:
            type: integer
        - in: query
          name : limit
          description: page size, default 10
          schema:
            type: integer
        - in: query
          name: name
          description: 规则名称
          schema:
              type: string
        - in: query
          name: status
          description: 任务状态
          schema:
            type: string
        - in: query
          name: event
          description: 训练事件
          schema:
            type: string
        - in: query
          name: gteCreatedAt
          description: 秒级时间戳,创建时间大于等于
          schema:
            type: integer
        - in: query
          name: ltCreatedAt
          description: 秒级时间戳,创建时间小于
          schema:
            type: integer
        - in: query
          name: gteStartAt
          description: 秒级时间戳,开始时间大于等于
          schema:
              type: integer
        - in: query
          name: ltStartAt
          description: 秒级时间戳,开始时间小于
          schema:
              type: integer
        - in: query
          name: gteEndAt
          description: 秒级时间戳,结束时间大于等于
          schema:
              type: integer
        - in: query
          name: ltEndAt
          description: 秒级时间戳,结束时间小于
          schema:
              type: integer


      responses:
        '200':
          description: got back the list of rule
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ruleList'
  /rule/api/v1/rule/remove:
    post:
      summary: 删除任务
      tags:
        - 规则聚合服务
      responses:
        '200':
          description: ' remove the specified rule'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ruleRemoveBody'
  /rule/api/v1/rule/get/{{id}}:
    get:
      summary: 获取任务详细信息
      tags:
        - 规则聚合服务
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: got back rule info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ruleResponse'
  /rule/api/v1/rule/enable/{{id}}:
    post:
      summary: 启用任务
      tags:
        - 规则聚合服务
      parameters:
        - in: path
          name: id
          description: 规则id
          schema:
              type: integer
      responses:
        '200':
          description: ' enable the specified rule'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'
  /rule/api/v1/rule/disable/{{id}}:
    post:
      summary: 禁用任务
      tags:
        - 规则聚合服务
      parameters:
        - in: path
          name: id
          description: 规则id
          schema:
              type: integer
      responses:
        '200':
          description: ' disable the specified rule'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/result'

components:
  schemas:
    result:
        type: object
        required:
            - code
            - msg
        properties:
            code:
              type: number
            msg:
              type: string
    error:
        type: object
        required:
            - code
            - msg
        properties:
            code:
              type: number
            msg:
              type: string
    resultData:
        type: object
        required:
            - code
            - msg
            - data
        properties:
            code:
              type: number
            msg:
              type: string
            data:
                type: object
    dataExportResult:
        type: object
        required:
            - status
            - body
        properties:
            status:
              type: number
            body:
              type: object
              required:
                  - url
              properties:
                  url:
                    type: string
    dataset:
      type: object
      required:
        - id
        - name
        - description
        - imageCount
        - labelCount
#        - classCount
#        - imageInfoList
        - labelInfoList
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        imageCount:
          type: number
          description: 包含样本总数量(每个样本可能含多个标注)
        labelCount:
          type: number
          description: 包含标注总数量
        labelInfoList:
          type: array
          items:
            $ref: '#/components/schemas/labelCategory'
#        imageInfoList:
#          type: array
#          items:
#            $ref: '#/components/schemas/labeledData'
        createdAt:
          type: number
        updatedAt:
          type: number
    datasets:
      type: object
      required:
        - code
        - data
        - count
      properties:
        code:
          type: number
        data:
          type: array
          items:
            $ref: '#/components/schemas/dataset'
        count:
          type: number
    datasetBody:
      type: object
      required:
        - name
        - description
      properties:
        name:
          type: string
        description:
          type: string
    datasetUpdateBody:
      type: object
      required:
        - name
        - description
      properties:
        name:
          type: string
        description:
          type: string
    datasetGetBody:
        type: object
        required:
            - code
            - msg
            - data
        properties:
            code:
              type: number
            msg:
              type: string
            data:
              $ref: '#/components/schemas/dataset'
    labelClasses:
      type: object
      required:
        - code
        - msg
        - data
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          type: object
          required:
            - list
            - count
          properties:
            list:
              type: array
              items:
                $ref: '#/components/schemas/labelClassBody'
            count:
              type: number
    labelClass:
     type: object
     required:
       - id
       - labelName
       - labelKey
       - labelColor
       - description
       - created
       - updated
     properties:
       id:
         type: string
       labelName:
         type: string
       labelKey:
         type: string
       labelColor:
         type: string
       description:
         type: string
       created:
         type: number
       updated:
         type: number
    labelClassAddBody:
      type: object
      required:
          - labelName
          - labelKey
          - labelColor
      properties:
          labelName:
            type: string
          labelKey:
            type: string
          labelColor:
            type: string
          description:
            type: string
    labelClassBody:
      type: object
      required:
          - code
          - msg
          - data
      properties:
          code:
              type: number
          msg:
              type: string
          data:
              type: object
              required:
                  - id
                  - labelName
                  - labelKey
                  - labelColor
                  - description
                  - createdAt
                  - updatedAt
              properties:
                  id:
                    type: integer
                  labelName:
                    type: string
                  labelKey:
                    type: string
                  labelColor:
                    type: string
                  description:
                    type: string
                  createdAt:
                    type: string
                    description: 创建时间 yyyy-MM-dd HH:mm:ss
                  updatedAt:
                    type: string
                    description: 更新时间 yyyy-MM-dd HH:mm:ss
    labelClassRemoveBody:
        type: object
        required:
            - labelClassIds
        properties:
            labelClassIds:
              type: array
              items:
                  type: integer
    labelClassUpdateBody:
        type: object
        required:
            - id
        properties:
            id:
              type: integer
            labelName:
              type: string
            labelKey:
              type: string
            labelColor:
              type: string
            description:
              type: string


    labeledData:
      type: object
      required:
        - id
        - createdAt
        - updatedAt
        - size
        - width
        - height
#        - source
        - sourceType
        - sourceId
        - imageUrl
        - labelUrl
        - labelInfoList
        - labelAnnotationList
      properties:
        id:
          type: string
        createdAt:
          type: string
          description: 创建时间 yyyy-MM-dd HH:mm:ss
        updatedAt:
            type: string
            description: 更新时间 yyyy-MM-dd HH:mm:ss
        width:
          type: integer
        height:
          type: integer
        size:
          type: integer
#        source:
#          type: string
        sourceType:
          type: integer
          description: 样本来源 0:导入,1:采集
        sourceId:
            type: string
            description: 样本来源id(sourceType为1时表示采集摄像头sn,sourceType为0时无意义)
        imageUrl:
          type: string
        labelUrl:
          type: string
        labelInfoList:
          type: array
          items:
            $ref: '#/components/schemas/labelCategory'
        labelAnnotationList:
          type: array
          items:
            $ref: '#/components/schemas/labelAnnotation'
    labeledDataRemoveBody:
      type: object
      required:
        - labeledDataIds
      properties:
        labeledDataIds:
          type: array
          items:
            type: string
    labeledDataUpdateBody:
      type: object
      required:
          - id
          - labelAnnotationList
      properties:
        id:
          type: string
        labelAnnotationList:
            type: array
            items:
              $ref: '#/components/schemas/labelAnnotation'
    labeledDataCheckBody:
        type: object
        required:
            - fileName
            - fileMd5
            - fileSize
            - chunkSize
            - builder
        properties:
            fileName:
              type: string
            fileMd5:
              type: string
            fileSize:
                type: number
            chunkSize:
                type: string
    labeledDataUploadBody:
        type: object
        required:
            - chunk
            - fileMd5
            - chunkMd5
            - file
        properties:
            chunk:
                type: integer
            fileMd5:
                type: string
            chunkMd5:
                type: string
            # The property name 'file' will be used for all files.
            file:
                type: array
                items:
                  type: string
                  format: binary
    labeledDataMergeBody:
        type: object
        required:
            - fileMd5
            - fileName
        properties:
            fileMd5:
              type: string
            fileName:
              type: string
    labeledDataLoadBody:
        type: object
        required:
            - filePath
            - fileName
        properties:
            filePath:
              type: string
            fileName:
              type: string
    labeledDataExportBody:
        type: object
        properties:
            sourceType:
              type: integer
            sourceId:
              type: string
            datasetsId:
              type: integer
            labelClassIds:
                type: array
                items:
                    type: integer
            gteCreatedAt:
              type: integer
            ltCreatedAt:
              type: integer
    labeledDataAdd:
      type: object
      required:
          - collection
          - source
          - sn
          - imageUrl
          - labelUrl
          - labelCategoryList
          - labelAnnotationList
      properties:
        collection:
          type: string
        source:
          type: string
        sn:
          type: string
        imageUrl:
          type: string
        labelUrl:
          type: string
        labelCategoryList:
          type: array
          items:
            $ref: '#/components/schemas/labelCategory'
        labelAnnotationList:
          type: array
          items:
            $ref: '#/components/schemas/labelAnnotation'
    labeledDataAddBody:
      type: object
      required:
          - labeledDataList
      properties:
        labeledDataList:
          type: array
          items:
            $ref: '#/components/schemas/labeledDataAdd'
    labeledDataGetBody:
        type: object
        required:
            - code
            - msg
            - data
        properties:
            code:
              type: number
            msg:
              type: string
            data:
                $ref: '#/components/schemas/labeledData'
    labeledDatas:
        type: object
        required:
        - code
        - data
        properties:
            code:
              type: number
            data:
              type: object
              required:
                  - list
                  - count
              properties:
                  list:
                    type: array
                    items:
                      $ref: '#/components/schemas/labeledData'
                  count:
                    type: number
    labelCategory:
      type: object
      required:
        - labelId
        - labelName
        - labelKey
        - labelColor
        - labelCount
        - imageCount
      properties:
        labelId:
            type: integer
        labelName:
            type: string
        labelKey:
            type: string
        labelColor:
            type: string
        imageCount:
            description: 含该标注样本数量(每个样本可能含多个标注)
            type: integer
        labelCount:
            description: 该标注数量
            type: integer
    labelAnnotationList:
        type: array
        items:
          $ref: '#/components/schemas/labelAnnotation'
    labelAnnotation:
        type: object
        required:
            - labelId
            - labelKey
            - labelName
            - labelColor
            - xMin
            - yMin
            - xMax
            - yMax
        properties:
            labelId:
                type: string
            labelKey:
                type: string
            labelName:
                type: string
            labelColor:
                type: string
            xMin:
                type: number
            yMin:
                type: number
            xMax:
                type: number
            yMax:
                type: number
    trainRule:
      type: object
      required:
        - id
        - name
        - description
        - priority
        - condition
        - targetList
#        - createdAt
#        - updatedAt
        - progressList
#        - effectiveDatatime
      properties:
        id:
          type: string
        name:
          type: string
        effectiveDatatime:
          type: object
          description: 规则生效时间
          required:
            - startTime
            - endTime
            - startDate
            - endDate
          properties:
            startTime:
              type: string
              description: 开始时间
            endTime:
              type: string
              description: 结束时间
            startDate:
              type: string
              description: 开始日期
            endDate:
              type: string
              description: 结束日期
        description:
          type: string
        priority:
          type: integer
          description: 优先级1-100
        condition:
          type: object
          required:
            - sampleQuantityThreshold
            - numberOfIterations
          properties:
            sampleQuantityThreshold:
              description: 样本增量大于阈值时触发
              type: integer
            numberOfIterations:
              description: 训练次数上限
              type: integer
        targetList:
          type: array
          items:
            type: string
            description: label key list
        progressList:
            type: array
            items:
              $ref: '#/components/schemas/modelProgress'

    trainRuleList:
      type: object
      required:
        - code
        - data
        - msg
        - count
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          type: array
          items:
            $ref: '#/components/schemas/trainRule'
        count:
          type: integer
    trainRuleStatusBody:
        type: object
        required:
            - ruleId
            - status
#            - progress
            - phase
            - remainingTime
        properties:
            ruleId:
                type: integer
            status:
                type: string
                enum:
                  - PENDING
                  - RUNNING
                  - SUCCESS
                  - FAILED
#                  - FINISHED
            progress:
                type: number
                description: 进度百分比
            phase:
                type: string
                description: 训练阶段
                enum:
                  - PREPARE
                  - TRAIN
                  - EVALUATE
                  - QUALITY
                  - FINISH
            remainingTime:
                type: number
                description: 剩余时间
    trainRuleBody:
      type: object
      required:
#        - name
#        - description
        - priority
        - condition
        - targetList
#        - effectiveDatatime
      properties:
        name:
          type: string
        description:
          type: string
        engineInfo:
          type: object
          required:
              - engineId
              - targetChip
          properties:
                engineId:
                    type: integer
                targetChip:
                    type: string
        priority:
          type: integer
          description: 优先级1-100
        condition:
          type: object
          required:
            - sampleQuantityThreshold
            - numberOfIterations
          properties:
            sampleQuantityThreshold:
              description: 距上次迭代样本增量大于阈值时触发
              type: integer
            numberOfIterations:
              description: 训练次数上限
              type: integer
        targetList:
          type: array
          items:
            type: string
            description: label key list
        effectiveDatatime:
          type: object
          description: 规则生效时间
          required:
            - startTime
            - endTime
            - startDate
            - endDate
          properties:
            startTime:
              type: string
              description: 开始时间
            endTime:
              type: string
              description: 结束时间
            startDate:
              type: string
              description: 开始日期
            endDate:
              type: string
              description: 结束日期
    datasetRuleBody:
      type: object
      required:
#        - name
#        - description
        - sourceList
#        - effectiveDatatime
      properties:
        name:
          type: string
        description:
          type: string
        effectiveDatatime:
          type: object
          description: 规则生效时间
          required:
            - startTime
            - endTime
            - startDate
            - endDate
          properties:
            startTime:
              type: string
              description: 开始时间
            endTime:
              type: string
              description: 结束时间
            startDate:
              type: string
              description: 开始日期
            endDate:
              type: string
              description: 结束日期
        sourceList:
          type: array
          items:
              type: object
              required:
                - brokerAddress
                - aiSn
                - cameraId
                - cameraAIInfo
              properties:
                brokerAddress:
                  type: string
                aiSn:
                  type: string
                cameraId:
                  type: string
                cameraAiInfo:
                  type: object
                  description: AI应用信息
                  required:
                    - cameraAIId
                    - interval
                    - objectThresh
                    - modelInfoList
                  properties:
                    cameraAIId:
                      type: string
                      description: AI应用ID
                    interval:
                        type: number
                        description: 采集间隔
                    objectThresh:
                        type: number
                        description: 告警目标阈值
                    modelInfoList:
                        type: array
                        description: 配置模型信息
                        items:
                            type: object
                            required:
                              - index
                              - modelId
                              - objLabels
                              - operator
                            properties:
                                index:
                                    type: number
                                    description: 模型优先级
                                modelId:
                                    type: string
                                    description: 模型ID
                                objLabels:
                                    type: array
                                    description: 目标标签列表
                                    items:
                                      type: string
                                operator:
                                    type: string
                                    description: 操作符 E 检测到所有目标 IN 检测到目标之一
                                    enum:
                                    - IN
    datasetRule:
       type: object
       required:
        - id
        - name
        - description
        - sourceList
        - createdAt
        - updatedAt
        - progressList
#        - effectiveDatatime
       properties:
          id:
            type: string
          name:
            type: string
          description:
            type: string
          sourceList:
            type: array
            items:
                type: object
                required:
                  - brokerAddress
                  - aiSn
                  - cameraId
                  - cameraAIInfo
                properties:
                  brokerAddress:
                    type: string
                  aiSn:
                    type: string
                  cameraId:
                    type: string
                  cameraAiInfo:
                    type: object
                    required:
                      - cameraAIId
                      - interval
                      - objectThresh
                      - modelInfoList
                    properties:
                      cameraAIId:
                        type: string
                      interval:
                          type: number
                      objectThresh:
                          type: number
                      modelInfoList:
                          type: array
                          items:
                              type: object
                              required:
                                - index
                                - modelId
                                - objLabels
                                - operator
                              properties:
                                  index:
                                      type: number
                                  modelId:
                                      type: string
                                  objLabels:
                                      type: array
                                      items:
                                        type: string
                                  operator:
                                      type: string
                                      enum:
                                      - IN
          created:
            type: number
          updated:
            type: number
          progressList:
              type: array
              description: 每个source的进度情况
              items:
                $ref: '#/components/schemas/datasetProgress'
          effectiveDatatime:
            type: object
            description: 规则生效时间
            required:
              - startTime
              - endTime
              - startDate
              - endDate
            properties:
                startTime:
                    type: string
                    description: 开始时间
                endTime:
                    type: string
                    description: 结束时间
                startDate:
                    type: string
                    description: 开始日期
                endDate:
                    type: string
                    description: 结束日期
    datasetRuleList:
      type: object
      required:
        - code
        - msg
        - data
        - count
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          type: array
          items:
            $ref: '#/components/schemas/datasetRule'
        count:
          type: integer

    device:
      type: object
      required:
        - box
        - camera
        - ai
      properties:
        box:
          type: object
          required:
            - sn
            - productId
            - online
            - ip
            - mqttInfo
          properties:
              sn:
                  type: string
                  description: 盒子SN
              productId:
                  type: string
                  description: 盒子产品ID
              online:
                  type: integer
                  description: 盒子是否在线 0 否 1 是
                  enum:
                      - 0
                      - 1
              ip:
                  type: string
                  description: 盒子IP
              mqttInfo:
                type: object
                required:
                  - host
                  - port
                  - username
                  - password
                properties:
                    host:
                        type: string
                        description: mqtt host
                    port:
                        type: integer
                        description: mqtt port
                    userName:
                        type: string
                        description: 用户名
                    passwd:
                        type: string
                        description: 密码

        camera:
          type: array
          items:
            type: object
            required:
              - sn
              - productId
              - online
            properties:
                sn:
                    type: string
                    description: 摄像头SN
                productId:
                    type: string
                    description: 摄像头产品ID

                online:
                    type: integer
                    description: 摄像头是否在线 0 否 1 是
                    enum:
                        - 0
                        - 1
        ai:
          type: array
          items:
            type: object
            required:
              - sn
              - productId
              - online
              - model
            properties:
                sn:
                    type: string
                    description: AI设备SN
                productId:
                    type: string
                    description: AI设备产品ID
                online:
                    type: integer
                    description: AI设备是否在线 0 否 1 是
                    enum:
                        - 0
                        - 1
                model:
                  type: string
                  description: AI型号
    ruleBody:
      type: object
      required:
        - name
        - sampleQuantityThreshold
        - event
        - deviceInfo
        - startDate
        - endDate
      properties:
        name:
          type: string
          description: 规则名称
        sampleQuantityThreshold:
          description: 样本增量阈值
          type: integer
          minimum: 500
          maximum: 100000
        deviceInfo:
          type: array
          description: 设备信息
          items:
            $ref: '#/components/schemas/device'
        event:
          type: string
          description: 任务关联事件
        enabled:
            type: integer
            description: 是否启用 0 否 1 是,默认1
            enum:
                - 0
                - 1
        startDate:
          type: string
          description: 开始日期,格式:yyyy-MM-dd
        endDate:
            type: string
            description: 结束日期,格式:yyyy-MM-dd
    ruleUpdateBody:
        type: object
        required:
            - id
        properties:
          id:
            type: integer
            description: 规则ID
          name:
            type: string
            description: 规则名称
          sampleQuantityThreshold:
            description: 样本增量阈值
            type: integer
          event:
              type: string
              description: 任务关联事件
          deviceInfo:
           type: array
           description: 设备信息
           items:
             $ref: '#/components/schemas/device'
          startDate:
            type: string
            description: 开始日期,格式:yyyy-MM-dd
          endDate:
              type: string
              description: 结束日期,格式:yyyy-MM-dd
    ruleRemoveBody:
      type: object
      required:
        - ids
      properties:
        ids:
          type: array
          items:
            type: integer
            description: 规则ID
    ruleEventBody:
          type: object
          required:
              - event
          properties:
            event:
                type: array
                items:
                  type: object
                  required:
                    - eventIdentifier
                    - eventName
                    - aiAppType
                    - type
                    - classificationList
                    - eventHoldTime
                    - knowledgePropertyList
                  properties:
                    eventIdentifier:
                      type: string
                      description: 事件标识符
                    eventName:
                      type: string
                      description: 事件名称
                    aiAppType:
                      type: string
                      description: AI应用类型
                    type:
                      type: string
                      description: 事件类型
                    classificationList:
                      type: array
                      description: 事件分类列表
                      items:
                        type: object
                        required:
                          - classification
                          - classificationName
                        properties:
                          classification:
                            type: string
                            description: 事件分类
                          classificationName:
                            type: string
                            description: 事件分类名称
                    eventHoldTime:
                      type: integer
                      description: 事件持续时间
                    knowledgePropertyList:
                      type: array
                      description: 知识属性列表
                      items:
                        type: object
                        required:
                          - property
                          - operator
                          - value
                        properties:
                          property:
                            type: string
                            description: 知识属性
                          operator:
                            type: string
                            description: 操作符
                          value:
                            type: string
                            description: 值
    ruleList:
      type: object
      required:
        - code
        - msg
        - data
#        - count
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          type: object
          required:
              - list
              - count
          properties:
            list:
              type: array
              items:
                $ref: '#/components/schemas/rule'
            count:
                type: integer
                description: 总数
    ruleResponse:
      type: object
      required:
        - code
        - msg
        - data
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          $ref: '#/components/schemas/rule'
    rule:
      type: object
      required:
        - id
        - name
        - enabled
        - createdAt
        - sampleQuantityThreshold
        - startDate
        - endDate
        - progress
        - event
        - status
        - sampleQuantityIncrement
        - iteratorCount
        - trainedSampleQuantity
      properties:
        id:
            type: integer
            description: 规则ID
        name:
            type: string
            description: 规则名称
        sampleQuantityThreshold:
            description: 样本增量阈值
            type: integer
        event:
            type: string
            description: 任务关联事件
        status:
            type: string
            description: 规则状态,PENDING 待命中, QUEUE 排队中, RUNNING 运行中, STOPPED 停止, EXPIRED 过期, FINISHED 完成, FAILED 失败
            enum:
                - PENDING
                - QUEUE
                - RUNNING
                - STOPPED
                - EXPIRED
                - FINISHED
                - FAILED
        sampleQuantityIncrement:
            type: integer
            description: 样本增量
        iteratorCount:
            type: integer
            description: 迭代次数
        trainedSampleQuantity:
            type: integer
            description: 已训练样本数量
        createdAt:
            type: string
            description: 创建时间,格式:yyyy-MM-dd HH:mm:ss
        enabled:
            type: integer
            description: 是否启用 0 否 1 是
            enum:
                - 0
                - 1
        startDate:
            type: string
            description: 开始日期,格式:yyyy-MM-dd
        endDate:
            type: string
            description: 结束日期,格式:yyyy-MM-dd
    trainRuleResponse:
      type: object
      required:
        - code
        - msg
        - data
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          $ref: '#/components/schemas/trainRule'
    datasetRuleResponse:
      type: object
      required:
          - code
          - msg
          - data
      properties:
            code:
                type: number
            msg:
                type: string
            data:
                $ref: '#/components/schemas/datasetRule'
    modelProgress:
      type: object
      required:
        - iterationNumber
        - models
      properties:
        iterationNumber:
          type: number
          description: 迭代次数
        model:
          type: object
          description: 模型信息
          required:
            - modelId
            - status
#            - progress
          properties:
            modelId:
              type: integer
              description: 模型ID
            status:
              type: string
              description: 模型状态
              enum:
                - PENDING
                - RUNNING
                - SUCCESS
                - FAILED

    datasetProgress:
      type: array
      description: 每个source的进度情况
      items:
        type: object
        required:
          - aiSn
          - sampleQuantity
        properties:
          aiSn:
            type: string
            description: AI设备SN
          sampleQuantity:
            type: number
            description: 样本采集数量

    modelList:
      type: object
      required:
        - code
        - msg
        - data
#        - count
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          type: object
          required:
              - list
              - count
          properties:
                list:
                  type: array
                  items:
                    $ref: '#/components/schemas/modelInfo'
                count:
                    type: integer
                    description: 总数
    modelInfo:
        type: object
        required:
            - id
            - name
            - status
            - ruleId
            - iteratorNumber
            - createdAt
            - chipType
            - engineId
            - algorithmType
            - datasetId
            - duration
            - labelClassSetObjInfo
            - evolutionSetObjInfo
            - downloadUrl
            - md5
            - coverUrl
            - status
            - sampleQuantity
        properties:
                id:
                    type: integer
                name:
                    type: string
                status:
                    type: integer
                    description: 模型使用状态,0:未使用,1:使用中
                    enum:
                      - 0
                      - 1
                ruleId:
                    type: integer
                    description: 训练任务Id
                iteratorNumber:
                    type: integer
                    description: 迭代次数
                createdAt:
                    type: integer
                chipType:
                    type: string
                    description: 芯片类型
                    enum:
                        - Rockchip,1808,NPU
                        - SOPHGO,SE5,NPU
                engineId:
                    type: integer
                    description: 引擎Id 1:共达地  0:7G
                    enum:
                      - 1
                      - 0
                algorithmType:
                    type: string
                    description: 算法类型
                    enum:
                        - Detection
                        - Compare
                        - Structuration
                datasetId:
                    type: integer
                    description: 训练数据集Id
                duration:
                    type: integer
                    description: 训练时长
                md5:
                    type: string
                    description: 模型md5
                downloadUrl:
                    type: string
                    description: 模型下载地址
                coverUrl:
                    type: string
                    description: 模型封面地址
                sampleQuantity:
                    type: integer
                    description: 训练样本数量

                labelClassSetObjInfo:
                    type: array
                    description: 训练标签类别信息
                    items:
                      type: object
                      required:
                          - id
                          - key
                          - name
                          - accuracy
                      properties:
                          id:
                              type: integer
                              description: 标签类别Id
                          key:
                              type: string
                              description: 标签类别key
                          name:
                              type: string
                              description: 标签类别名称
                          accuracy:
                              type: number
                              description: 标签类别准确率
                evolutionSetObjInfo:
                    type: array
                    description: 进化信息
                    items:
                      type: object
                      required:
                          - id
                          - key
                          - name
                          - labelClassAccuracy
                      properties:
                          id:
                              type: integer
                              description: 模型Id
                          key:
                              type: string
                              description: 标签类别key
                          name:
                              type: string
                              description: 标签名称
                          labelClassAccuracy:
                              type: object
                              description: 模型准确率
                              required:
                                  - key
                                  - accuracy
                                  - name
                                  - id
                              properties:
                                    key:
                                        type: string
                                        description: 标签类别key
                                    accuracy:
                                        type: number
                                        description: 标签类别准确率
                                    name:
                                        type: string
                                        description: 标签类别名称
                                    id:
                                        type: integer
                                        description: 标签类别Id
    modelInfos:
        type: object
        required:
            - items
            - total
        properties:
            items:
              type: array
              items:
                  $ref: '#/components/schemas/modelInfo'
            total:
              type: number
    modelImportBody:
      type: object
      required:
        - md5
      properties:
        md5:
          type: string
          description: 模型md5
    modelUpdateBody:
      type: object
      required:
        - id
        - name
        - description
      properties:
        id:
          type: integer
        name:
          type: string
        description:
          type: string
    modelGetBody:
      type: object
      required:
        - code
        - msg
        - data
      properties:
        code:
          type: number
        msg:
          type: string
        data:
          $ref: '#/components/schemas/modelInfo'
